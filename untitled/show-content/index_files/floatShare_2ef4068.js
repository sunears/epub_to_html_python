define("wiki-mobile-common:widget/component/share/floatShare.js",function(a,e,r){var i=a("wiki-mobile-common:widget/lib/zepto/zepto.js"),t=a("wiki-mobile-common:widget/component/share/share.js"),o=a("wiki-mobile-common:widget/lib/qrcode/qrcode.js"),m=a("wiki-mobile-common:widget/util/nslog.js");a("wiki-mobile-common:widget/util/baidubox.js");var n={init:function(a){var e=this;e.param=a,e.param.url=e.param.url||window.location.href,e.param.pic=e.param.pic||"http://wapbaike.baidu.com/cms/rc/wapShareDefault.png",e.param.title=e.param.title||i("title").html(),e.param.desc=e.param.desc.length>80?e.param.desc.substr(0,80)+"...":e.param.desc,e.param.url.length>150&&(e.param.url=e.param.url.split("?")[0]),t.initShoubaiShare(e.param.title,e.param.desc,e.param.pic,e.param.url,e.param.shareBtnId),window.location.href.indexOf("bk_share=qqbrowser")>-1&&window.SQB.run({appId:"wxc7f1fef5ecb67519"}),t.initWechatShare(e.param.title,e.param.desc,e.param.pic,e.param.url),e.shareEvent()},shareEvent:function(){var a=this;i("#"+a.param.shareBtnId).tap(function(){if(Box.isBox)return void(t.newLemmaId?m.q2(a.param.otherLog.shoubai,["newLemmaId="+t.newLemmaId]):m.q2(a.param.otherLog.shoubai));var e=navigator.userAgent;if(e.indexOf("baidubrowser")>-1&&e.indexOf("en-us")<=-1)return t.newLemmaId?m.q2(a.param.otherLog.baidu,["newLemmaId="+t.newLemmaId]):m.q2(a.param.otherLog.baidu),void t.initBaiduShare(a.param.title,a.param.desc,a.param.pic,a.param.url);if(e.indexOf("UCBrowser")>-1)return t.newLemmaId?m.q2(a.param.otherLog.uc,["newLemmaId="+t.newLemmaId]):m.q2(a.param.otherLog.uc),void t.initUCShare(a.param.title,a.param.desc,a.param.pic,a.param.url);if(e.indexOf("QQBrowser")>-1&&e.indexOf("MicroMessenger")<=-1){var r=e.match(/QQBrowser\/(\S*)[\s]Mobile/)[1];if(parseFloat(r)>=6)return t.newLemmaId?m.q2(a.param.otherLog.qq,["newLemmaId="+t.newLemmaId]):m.q2(a.param.otherLog.qq),void t.initQQShare(a.param.title,a.param.desc,a.param.pic,a.param.url)}return e.indexOf("MicroMessenger")>-1?(t.newLemmaId?m.q2(a.param.otherLog.weixin,["newLemmaId="+t.newLemmaId]):m.q2(a.param.otherLog.weixin),i("#J-share-layer").css({display:"block",opacity:"0.8"}),void i("#J-wechat-share-tip").show()):(i("#J-share-layer").css({display:"block"}),void i(".float-share").show())}).on("touchstart",function(a){a.preventDefault()}),i("#J-float-share-btn").tap(function(){i("#J-share-layer").hide(),i(".float-share").hide()}),i("#J-share-layer").on("touchstart",function(a){a.preventDefault(),i(".float-share").hide(),i("#J-float-wechat-qrcode").hide(),i("#J-wechat-share-tip").hide(),i(this).hide()}).on("tap",function(){i("#J-wechat-share-tip").hide()});var e=!0;i("#J-float-wechat").tap(function(){if(t.newLemmaId?m.qArray(a.param.weixinLog,["newLemmaId="+t.newLemmaId]):m.q(a.param.weixinLog),i(".float-share").hide(),i("#J-float-wechat-qrcode").show(),a.changeParam&&(i("#J-float-wechat-qrcode-img").html(""),e=!0),e){var r=new o(document.getElementById("J-float-wechat-qrcode-img"),{width:180,height:180}),n=t.shareUrl(a.param.url,"weixin");r.makeCode(n),e=!1}}),i("#J-float-wechat-qrcode-close").tap(function(){i(".float-share").show(),i("#J-float-wechat-qrcode").hide()}),i(".float-share .share-link").tap(function(){var e=i(this).attr("class").split(" ")[1],r=t.shareUrl(a.param.url,e);t.initBaikeShare(e,a.param.title,a.param.desc,r,a.param.pic,{sina:a.param.sinaLog,qq:a.param.qqLog})}),i("#J-float-wechat, #J-float-wechat-qrcode-close, #J-float-share-btn, .float-share .share-link").on("touchstart",function(a){a.preventDefault()}),i(".float-share").on("touchstart",function(a){a.preventDefault()})},uploadParam:function(a){var e=this;if(e.changeParam=!0,e.param.isImgShare&&""!==e.param.isImgShare){e.param.pic=a.shareUrl&&""!==a.shareUrl?a.shareUrl:"http://imgsrc.baidu.com/baike/pic/item/"+a.src+".jpg";var r=window.location.href.split("/"),i=r.length;e.param.url=window.location.href.split(r[i-2]+"/"+r[i-1])[0],e.param.url+=a.aid+"/"+a.src,t.initShoubaiShare(e.param.title,e.param.desc,e.param.pic,e.param.url,e.param.shareBtnId),t.onChangeHashWechatShare(e.param.title,e.param.desc,e.param.pic,e.param.url)}e.param.isShijiDrawShare&&""!==e.param.isShijiDrawShare&&(e.param.title="我的2015年，就是这个样",e.param.pic=a.pic,e.param.url="http://"+window.location.host+"/shiji/myshiji?drawingId="+a.drawingId,t.initShoubaiShare(e.param.title,e.param.desc,e.param.pic,e.param.url,e.param.shareBtnId),t.onChangeHashWechatShare(e.param.title,e.param.desc,e.param.pic,e.param.url))}};r.exports=n});